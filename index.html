<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameRent Pro - เช่าไอดีเกมครบวงจร</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap');
        body { font-family: 'Kanit', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        .glass {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .admin-badge {
            background: linear-gradient(45deg, #ef4444, #f59e0b);
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 4px; }
    </style>
</head>
<body class="min-h-screen flex flex-col">

    <nav class="glass sticky top-0 z-50 px-6 py-4 shadow-lg">
        <div class="container mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <i class="fa-solid fa-gamepad text-3xl text-blue-500"></i>
                <h1 class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-blue-400 to-purple-500">GameRent Pro</h1>
            </div>
            
            <div id="nav-menu" class="hidden md:flex gap-6 items-center">
                <button onclick="showPage('home')" class="hover:text-blue-400 transition">หน้าแรก</button>
                <button onclick="showPage('auction')" class="hover:text-blue-400 transition">ประมูลไอดี</button>
                <button onclick="showPage('topup')" class="hover:text-blue-400 transition">เติมเงิน</button>
                <button onclick="toggleChat()" class="relative hover:text-blue-400 transition">
                    <i class="fa-solid fa-comment-dots text-xl"></i>
                    <span class="absolute -top-2 -right-2 bg-red-500 text-xs rounded-full w-4 h-4 flex items-center justify-center">1</span>
                </button>
                
                <div id="user-info" class="flex items-center gap-3 ml-4 bg-slate-800 py-1 px-3 rounded-full border border-slate-700">
                    <span id="user-balance" class="text-green-400 font-bold">฿0.00</span>
                    <span id="user-email" class="text-sm text-gray-300">Guest</span>
                    <button onclick="logout()" class="text-red-400 hover:text-red-300"><i class="fa-solid fa-right-from-bracket"></i></button>
                </div>
            </div>

            <div id="auth-buttons">
                <button onclick="showPage('login')" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-full transition shadow-lg shadow-blue-500/30">เข้าสู่ระบบ</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-6 flex-grow relative">

        <div id="page-login" class="max-w-md mx-auto mt-10 glass p-8 rounded-2xl shadow-2xl hidden">
            <h2 class="text-3xl font-bold text-center mb-6">ยินดีต้อนรับ</h2>
            <div class="flex gap-4 mb-6">
                <button onclick="toggleAuthMode('login')" class="flex-1 py-2 rounded-lg bg-blue-600 text-white" id="btn-mode-login">เข้าสู่ระบบ</button>
                <button onclick="toggleAuthMode('register')" class="flex-1 py-2 rounded-lg bg-slate-700 text-gray-400 hover:bg-slate-600" id="btn-mode-register">สมัครสมาชิก</button>
            </div>
            
            <form id="auth-form" onsubmit="handleAuth(event)">
                <div class="mb-4">
                    <label class="block text-gray-400 mb-2">อีเมล</label>
                    <input type="email" id="email" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-3 focus:outline-none focus:border-blue-500 transition" required>
                </div>
                <div class="mb-4">
                    <label class="block text-gray-400 mb-2">รหัสผ่าน</label>
                    <input type="password" id="password" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-3 focus:outline-none focus:border-blue-500 transition" required>
                </div>
                <div id="forgot-pass-link" class="text-right mb-6">
                    <a href="#" onclick="forgotPassword()" class="text-sm text-blue-400 hover:underline">ลืมรหัสผ่าน?</a>
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-500 hover:to-blue-400 text-white font-bold py-3 rounded-lg shadow-lg transform transition hover:scale-105">ยืนยัน</button>
            </form>
        </div>

        <div id="page-home" class="hidden">
            <div class="flex justify-between items-end mb-8">
                <div>
                    <h2 class="text-4xl font-bold text-white mb-2">บริการเช่าไอดีเกม <span class="text-blue-500">Premium</span></h2>
                    <p class="text-gray-400">เลือกเกมที่คุณต้องการเล่นได้ทันที</p>
                </div>
                <input type="text" placeholder="ค้นหาเกม..." class="bg-slate-800 border border-slate-700 rounded-lg px-4 py-2 w-64 focus:outline-none focus:border-blue-500">
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="rental-grid">
                </div>
        </div>

        <div id="page-auction" class="hidden">
            <h2 class="text-3xl font-bold mb-6 text-yellow-500"><i class="fa-solid fa-gavel"></i> ประมูลไอดีเทพ</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="auction-grid">
                <div class="glass p-6 rounded-xl relative overflow-hidden group hover:border-yellow-500/50 transition duration-300">
                    <div class="absolute top-0 right-0 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-bl-lg animate-pulse">Live</div>
                    <img src="https://via.placeholder.com/400x200/000000/FFFFFF?text=Valorant+Skin+Rare" class="w-full h-40 object-cover rounded-lg mb-4 opacity-80 group-hover:opacity-100 transition">
                    <h3 class="text-xl font-bold mb-2">Valorant ID: Full Skin (Vandal RGX)</h3>
                    <div class="flex justify-between items-center bg-slate-800 p-3 rounded-lg mb-4">
                        <span class="text-gray-400 text-sm">ราคาสูงสุดปัจจุบัน</span>
                        <span class="text-2xl font-bold text-green-400">฿1,250</span>
                    </div>
                    <div class="flex gap-2">
                         <input type="number" placeholder="ใส่ราคาประมูล" class="flex-1 bg-slate-900 border border-slate-700 rounded-lg px-3 py-2">
                         <button onclick="placeBid()" class="bg-yellow-600 hover:bg-yellow-500 text-white px-4 py-2 rounded-lg font-bold">บิดเลย!</button>
                    </div>
                    <p class="text-xs text-center mt-3 text-gray-500">สิ้นสุดใน: 02:15:30</p>
                </div>
            </div>
        </div>

        <div id="page-topup" class="hidden max-w-2xl mx-auto">
            <h2 class="text-3xl font-bold mb-6 text-center">เติมเงินเข้าสู่ระบบ</h2>
            <div class="glass p-8 rounded-2xl">
                <div class="flex justify-center mb-6">
                     <img src="https://via.placeholder.com/200?text=QR+Code+PromptPay" alt="QR Code" class="rounded-lg border-4 border-white">
                </div>
                <div class="text-center mb-6">
                    <p class="text-lg">ธนาคาร: <span class="font-bold text-blue-400">กสิกรไทย (K-Bank)</span></p>
                    <p class="text-lg">เลขบัญชี: <span class="font-bold text-xl copy-text cursor-pointer" onclick="copyText('123-4-56789-0')">123-4-56789-0 <i class="fa-regular fa-copy text-sm ml-2"></i></span></p>
                    <p class="text-sm text-gray-400 mt-2">ชื่อบัญชี: บจก. เกมเรนท์ โปร จำกัด</p>
                </div>
                <hr class="border-gray-700 my-6">
                <form onsubmit="submitTopup(event)">
                    <div class="mb-4">
                        <label class="block text-gray-400 mb-2">จำนวนเงินที่โอน (บาท)</label>
                        <input type="number" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-3" placeholder="เช่น 100.00" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-400 mb-2">แนบสลิปการโอนเงิน</label>
                        <input type="file" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-2 text-sm file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-700" accept="image/*" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-400 mb-2">เวลาที่โอน (ตามสลิป)</label>
                        <input type="datetime-local" class="w-full bg-slate-800 border border-slate-600 rounded-lg p-3" required>
                    </div>
                    <button type="submit" class="w-full bg-green-600 hover:bg-green-500 text-white font-bold py-3 rounded-lg shadow-lg">แจ้งเติมเงิน</button>
                </form>
            </div>
        </div>

        <div id="page-admin" class="hidden">
            <div class="flex justify-between items-center mb-6 bg-red-900/30 p-4 rounded-xl border border-red-500/50">
                <h2 class="text-3xl font-bold text-red-400"><i class="fa-solid fa-user-shield"></i> Admin Dashboard</h2>
                <div class="text-sm text-gray-300">Logged in as: <span class="font-bold text-white">farisxuma1@gmail.com</span></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
                <div class="bg-slate-800 p-4 rounded-lg border-l-4 border-blue-500">
                    <p class="text-gray-400 text-sm">ผู้ใช้งานทั้งหมด</p>
                    <p class="text-2xl font-bold">1,204</p>
                </div>
                <div class="bg-slate-800 p-4 rounded-lg border-l-4 border-green-500">
                    <p class="text-gray-400 text-sm">ยอดเติมเงินรออนุมัติ</p>
                    <p class="text-2xl font-bold">5</p>
                </div>
                <div class="bg-slate-800 p-4 rounded-lg border-l-4 border-yellow-500">
                    <p class="text-gray-400 text-sm">ไอดีว่างให้เช่า</p>
                    <p class="text-2xl font-bold">42</p>
                </div>
                <div class="bg-slate-800 p-4 rounded-lg border-l-4 border-purple-500">
                    <p class="text-gray-400 text-sm">รายได้วันนี้</p>
                    <p class="text-2xl font-bold">฿8,540</p>
                </div>
            </div>

            <div class="mb-6 border-b border-gray-700">
                <ul class="flex flex-wrap -mb-px text-sm font-medium text-center" id="admin-tabs">
                    <li class="mr-2">
                        <button class="inline-block p-4 text-blue-500 border-b-2 border-blue-500 rounded-t-lg active" onclick="switchAdminTab('products')">จัดการสินค้า</button>
                    </li>
                    <li class="mr-2">
                        <button class="inline-block p-4 hover:text-gray-300 hover:border-gray-300 rounded-t-lg" onclick="switchAdminTab('users')">จัดการผู้ใช้</button>
                    </li>
                    <li class="mr-2">
                        <button class="inline-block p-4 hover:text-gray-300 hover:border-gray-300 rounded-t-lg relative" onclick="switchAdminTab('topups')">
                            อนุมัติเติมเงิน <span class="bg-red-500 text-white text-xs px-2 rounded-full ml-1">5</span>
                        </button>
                    </li>
                </ul>
            </div>

            <div id="admin-products" class="glass p-6 rounded-xl">
                <h3 class="text-xl font-bold mb-4">ลงสินค้า/ไอดีเช่าใหม่</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <input type="text" placeholder="ชื่อเกม / ชื่อแพ็คเกจ" class="bg-slate-900 border border-slate-700 rounded p-2">
                    <input type="number" placeholder="ราคาต่อชั่วโมง (บาท)" class="bg-slate-900 border border-slate-700 rounded p-2">
                    <input type="text" placeholder="Username (ไอดีเกม)" class="bg-slate-900 border border-slate-700 rounded p-2">
                    <input type="text" placeholder="Password (รหัสเกม)" class="bg-slate-900 border border-slate-700 rounded p-2">
                </div>
                <textarea placeholder="รายละเอียดไอดี (เช่น สกิน, แรงค์)" class="w-full bg-slate-900 border border-slate-700 rounded p-2 mb-4 h-24"></textarea>
                <div class="flex justify-end">
                    <button class="bg-green-600 hover:bg-green-500 text-white px-6 py-2 rounded-lg font-bold" onclick="Swal.fire('สำเร็จ', 'ลงประกาศเช่าเรียบร้อย', 'success')">ลงสินค้า</button>
                </div>
            </div>
            <div id="admin-users" class="glass p-6 rounded-xl hidden">
                <h3 class="text-xl font-bold mb-4">รายชื่อผู้ใช้</h3>
                <table class="w-full text-left text-sm text-gray-400">
                    <thead class="bg-slate-900 text-gray-200 uppercase">
                        <tr>
                            <th class="p-3">Email</th>
                            <th class="p-3">Balance</th>
                            <th class="p-3">Status</th>
                            <th class="p-3">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b border-slate-700">
                            <td class="p-3">user01@test.com</td>
                            <td class="p-3">฿50.00</td>
                            <td class="p-3"><span class="bg-green-900 text-green-300 py-1 px-2 rounded text-xs">Active</span></td>
                            <td class="p-3"><button class="text-blue-400 hover:underline">Edit</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </main>

    <div id="chat-widget" class="fixed bottom-4 right-4 w-80 h-96 bg-slate-800 rounded-t-xl shadow-2xl flex flex-col hidden border border-slate-600 z-50">
        <div class="bg-blue-700 p-3 rounded-t-xl flex justify-between items-center cursor-pointer" onclick="toggleChat()">
            <span class="font-bold text-white"><i class="fa-solid fa-headset mr-2"></i> Support Chat</span>
            <i class="fa-solid fa-chevron-down text-white"></i>
        </div>
        <div class="flex-grow p-4 overflow-y-auto bg-slate-900" id="chat-messages">
            <div class="flex justify-start mb-2">
                <div class="bg-slate-700 text-white p-2 rounded-lg max-w-[80%] text-sm">
                    สวัสดีครับ มีอะไรให้แอดมินช่วยไหมครับ?
                </div>
            </div>
        </div>
        <div class="p-3 bg-slate-800 border-t border-slate-700 flex">
            <input type="text" id="chat-input" class="flex-grow bg-slate-900 border border-slate-700 rounded-l-lg px-3 py-2 text-sm focus:outline-none" placeholder="พิมพ์ข้อความ...">
            <button onclick="sendMessage()" class="bg-blue-600 text-white px-3 rounded-r-lg hover:bg-blue-500"><i class="fa-solid fa-paper-plane"></i></button>
        </div>
    </div>

    <script>
        // --- Configuration ---
        const ADMIN_EMAIL = 'farisxuma1@gmail.com';
        let currentUser = null; // null = guest

        // --- Mock Data ---
        const products = [
            { id: 1, name: 'Valorant Rank Diamond', price: 15, image: 'https://via.placeholder.com/300x150?text=Valorant' },
            { id: 2, name: 'GTA V FiveM Ready', price: 10, image: 'https://via.placeholder.com/300x150?text=GTA+V' },
            { id: 3, name: 'Netflix Premium 4K', price: 5, image: 'https://via.placeholder.com/300x150?text=Netflix' },
        ];

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderProducts();
            showPage('home'); // Default page
        });

        // --- Navigation Logic ---
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('main > div').forEach(div => div.classList.add('hidden'));
            
            // Show requested page
            const target = document.getElementById(`page-${pageId}`);
            if (target) {
                target.classList.remove('hidden');
            } else {
                console.error('Page not found:', pageId);
            }

            // Auth Logic Visualization
            const authBtns = document.getElementById('auth-buttons');
            const navMenu = document.getElementById('nav-menu');
            
            if (currentUser) {
                authBtns.classList.add('hidden');
                navMenu.classList.remove('hidden');
                navMenu.classList.add('flex');
                document.getElementById('user-email').textContent = currentUser.email;
                
                // Show Admin Menu if admin
                if (currentUser.email === ADMIN_EMAIL && pageId !== 'admin') {
                   // Add admin button dynamically if needed or just redirect logic
                }
            } else {
                authBtns.classList.remove('hidden');
                navMenu.classList.add('hidden');
                navMenu.classList.remove('flex');
                if (pageId !== 'login' && pageId !== 'home') {
                    // Redirect to login if accessing protected pages
                     Swal.fire({
                        icon: 'warning',
                        title: 'กรุณาเข้าสู่ระบบ',
                        text: 'คุณต้องเข้าสู่ระบบก่อนใช้งานหน้านี้',
                        showConfirmButton: false,
                        timer: 1500
                    });
                    showPage('login');
                }
            }
        }

        // --- Authentication ---
        function toggleAuthMode(mode) {
            const btnLogin = document.getElementById('btn-mode-login');
            const btnReg = document.getElementById('btn-mode-register');
            
            if (mode === 'login') {
                btnLogin.classList.replace('bg-slate-700', 'bg-blue-600');
                btnLogin.classList.replace('text-gray-400', 'text-white');
                btnReg.classList.replace('bg-blue-600', 'bg-slate-700');
                btnReg.classList.replace('text-white', 'text-gray-400');
            } else {
                btnReg.classList.replace('bg-slate-700', 'bg-blue-600');
                btnReg.classList.replace('text-gray-400', 'text-white');
                btnLogin.classList.replace('bg-blue-600', 'bg-slate-700');
                btnLogin.classList.replace('text-white', 'text-gray-400');
            }
        }

        function handleAuth(e) {
            e.preventDefault();
            const email = document.getElementById('email').value;
            // Mock Login
            currentUser = { email: email, balance: 0 };
            
            Swal.fire({
                icon: 'success',
                title: 'เข้าสู่ระบบสำเร็จ',
                timer: 1000,
                showConfirmButton: false
            }).then(() => {
                if (email === ADMIN_EMAIL) {
                    showPage('admin');
                } else {
                    showPage('home');
                }
            });
        }

        function logout() {
            currentUser = null;
            showPage('home');
            Swal.fire('ออกจากระบบ', 'ไว้เจอกันใหม่นะ!', 'success');
        }

        function forgotPassword() {
            Swal.fire({
                title: 'ลืมรหัสผ่าน',
                input: 'email',
                inputLabel: 'กรุณากรอกอีเมลของคุณ',
                inputPlaceholder: 'user@example.com',
                showCancelButton: true,
                confirmButtonText: 'ส่งลิงก์รีเซ็ต',
                confirmButtonColor: '#3b82f6'
            }).then((result) => {
                if (result.isConfirmed) {
                    Swal.fire('ส่งแล้ว!', 'ตรวจสอบอีเมลของคุณเพื่อตั้งรหัสผ่านใหม่', 'success');
                }
            });
        }

        // --- Rental System ---
        function renderProducts() {
            const container = document.getElementById('rental-grid');
            container.innerHTML = products.map(p => `
                <div class="glass p-4 rounded-xl hover:shadow-2xl hover:shadow-blue-500/20 transition duration-300 group">
                    <div class="overflow-hidden rounded-lg mb-4">
                        <img src="${p.image}" class="w-full h-40 object-cover transform group-hover:scale-110 transition duration-500">
                    </div>
                    <h3 class="text-xl font-bold text-white mb-1">${p.name}</h3>
                    <div class="flex justify-between items-center mb-4">
                        <span class="text-blue-400">ว่างพร้อมเช่า</span>
                        <span class="text-2xl font-bold text-yellow-400">฿${p.price}<span class="text-sm text-gray-400">/ชม.</span></span>
                    </div>
                    <button onclick="rentItem(${p.id}, '${p.name}', ${p.price})" class="w-full bg-blue-600 hover:bg-blue-500 text-white font-bold py-2 rounded-lg transition">
                        เช่าเลย
                    </button>
                </div>
            `).join('');
        }

        function rentItem(id, name, price) {
            if (!currentUser) { showPage('login'); return; }

            Swal.fire({
                title: `เช่า ${name}`,
                html: `
                    <div class="mb-4 text-left">
                        <label>เลือกจำนวนชั่วโมง:</label>
                        <input type="range" id="rent-hours" min="1" max="24" value="1" class="w-full mt-2" oninput="updatePrice(this.value, ${price})">
                        <div class="flex justify-between mt-2 font-bold">
                            <span id="hours-display">1 ชม.</span>
                            <span id="price-display" class="text-yellow-400">฿${price}</span>
                        </div>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'ยืนยันการเช่า',
                confirmButtonColor: '#10b981',
                preConfirm: () => {
                    return document.getElementById('rent-hours').value;
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    const hours = result.value;
                    const total = hours * price;
                    Swal.fire('สำเร็จ!', `คุณได้เช่า ${name} เป็นเวลา ${hours} ชม. <br>ระบบส่ง ID/Pass เข้าทางแชทแล้ว`, 'success');
                }
            });
        }

        window.updatePrice = function(hours, price) {
            document.getElementById('hours-display').innerText = `${hours} ชม.`;
            document.getElementById('price-display').innerText = `฿${hours * price}`;
        }

        // --- Topup System ---
        function submitTopup(e) {
            e.preventDefault();
            Swal.fire({
                title: 'กำลังตรวจสอบ...',
                text: 'กรุณารอสักครู่ แอดมินกำลังตรวจสอบสลิป',
                icon: 'info',
                timer: 2000,
                showConfirmButton: false
            }).then(() => {
                Swal.fire('แจ้งเติมเงินสำเร็จ', 'กรุณารอแอดมินอนุมัติภายใน 5 นาที', 'success');
                showPage('home');
            });
        }

        // --- Chat System ---
        function toggleChat() {
            const chat = document.getElementById('chat-widget');
            chat.classList.toggle('hidden');
        }

        function sendMessage() {
            const input = document.getElementById('chat-input');
            const msg = input.value;
            if(!msg) return;

            const chatBox = document.getElementById('chat-messages');
            chatBox.innerHTML += `
                <div class="flex justify-end mb-2">
                    <div class="bg-blue-600 text-white p-2 rounded-lg max-w-[80%] text-sm">
                        ${msg}
                    </div>
                </div>
            `;
            input.value = '';
            chatBox.scrollTop = chatBox.scrollHeight;
        }

        // --- Admin Logic ---
        function switchAdminTab(tab) {
            // Hide all tab content
            document.getElementById('admin-products').classList.add('hidden');
            document.getElementById('admin-users').classList.add('hidden');
            // Show selected
            document.getElementById(`admin-${tab}`).classList.remove('hidden');
        }

        function copyText(text) {
            navigator.clipboard.writeText(text);
            const Toast = Swal.mixin({
                toast: true,
                position: 'top-end',
                showConfirmButton: false,
                timer: 1500,
                timerProgressBar: true
            });
            Toast.fire({
                icon: 'success',
                title: 'คัดลอกแล้ว'
            });
        }
    </script>
</body>
</html>
