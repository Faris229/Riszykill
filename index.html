<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SafeTrade | ‡πÄ‡∏ß‡πá‡∏ö‡∏Å‡∏•‡∏≤‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢</title>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet">

    <style>
        :root { --bg: #111827; --card: #1f2937; --primary: #3b82f6; --text: #f3f4f6; --success: #10b981; }
        body { font-family: 'Prompt', sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 50px; }
        
        /* Auth Screen */
        #auth-screen { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .auth-box { background: var(--card); padding: 30px; border-radius: 16px; width: 100%; max-width: 400px; text-align: center; border: 1px solid #374151; }
        
        input, select { width: 100%; padding: 12px; margin-bottom: 10px; background: #374151; border: 1px solid #4b5563; color: white; border-radius: 8px; box-sizing: border-box; }
        
        .btn { width: 100%; padding: 12px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; transition: 0.2s; margin-bottom: 5px; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-green { background: var(--success); color: white; }
        .btn-red { background: #ef4444; color: white; }
        .btn-outline { background: transparent; border: 1px solid #4b5563; color: #9ca3af; }

        /* Navbar */
        .navbar { background: var(--card); padding: 15px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #374151; position: sticky; top: 0; z-index: 100; }
        .balance-badge { background: #374151; padding: 5px 12px; border-radius: 20px; font-size: 0.9rem; color: var(--success); font-weight: bold; }

        /* Lobby */
        .container { max-width: 800px; margin: 0 auto; padding: 20px; }
        .room-card { background: var(--card); padding: 20px; border-radius: 12px; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #374151; }
        .locked-icon { color: #f59e0b; margin-left: 5px; }

        /* Chat Room */
        .chat-container { display: flex; flex-direction: column; height: 80vh; background: var(--card); border-radius: 12px; overflow: hidden; border: 1px solid #374151; }
        .chat-header { padding: 15px; background: #111827; border-bottom: 1px solid #374151; display: flex; justify-content: space-between; align-items: center; }
        .chat-messages { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .chat-input-area { padding: 15px; background: #111827; display: flex; gap: 10px; }

        .msg { padding: 10px 15px; border-radius: 12px; max-width: 75%; font-size: 0.9rem; position: relative; }
        .msg-me { background: var(--primary); align-self: flex-end; color: white; border-bottom-right-radius: 2px; }
        .msg-other { background: #374151; align-self: flex-start; color: white; border-bottom-left-radius: 2px; }
        .msg-system { align-self: center; background: rgba(16, 185, 129, 0.2); color: var(--success); font-size: 0.8rem; padding: 5px 15px; border-radius: 20px; border: 1px solid var(--success); }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="auth-box">
            <h2 style="margin-top:0;">SafeTrade Login</h2>
            <div id="login-form">
                <input id="l-email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
                <input id="l-pass" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                <button class="btn btn-primary" onclick="login()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
                <button class="btn btn-outline" onclick="toggleAuth('reg')">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
            </div>
            
            <div id="reg-form" style="display:none;">
                <input id="r-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô / ‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô">
                <input id="r-email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•">
                <input id="r-pass" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
                <select id="r-bank">
                    <option value="kbank">‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡πÑ‡∏ó‡∏¢</option>
                    <option value="scb">‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå</option>
                    <option value="wallet">TrueMoney Wallet</option>
                </select>
                <input id="r-bank-no" placeholder="‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ / ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ß‡∏≠‡∏•‡πÄ‡∏•‡πá‡∏ó">
                <input id="r-acc-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ">
                <button class="btn btn-green" onclick="register()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏Ñ‡∏£</button>
                <button class="btn btn-outline" onclick="toggleAuth('login')">‡∏Å‡∏•‡∏±‡∏ö</button>
            </div>
        </div>
    </div>

    <div id="app" style="display:none;">
        <nav class="navbar">
            <div style="font-weight:bold; font-size:1.2rem;"><i class="fa-solid fa-handshake"></i> SafeTrade</div>
            <div style="display:flex; align-items:center; gap:10px;">
                <div class="balance-badge"><i class="fa-solid fa-wallet"></i> <span id="my-bal">0</span> ‡∏ø</div>
                <button class="btn btn-outline" style="width:auto; padding:5px 10px;" onclick="logout()"><i class="fa-solid fa-power-off"></i></button>
            </div>
        </nav>

        <div class="container">
            <div style="display:grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap:10px; margin-bottom:20px;">
                <button class="btn btn-green" onclick="createRoomPopup()">+ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á</button>
                <button class="btn btn-primary" onclick="depositPopup()">‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</button>
                <button class="btn btn-red" onclick="withdrawPopup()">‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</button>
                <button class="btn btn-outline" style="background:#374151; color:white;" onclick="contactAdmin()">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
            </div>

            <h3 style="border-bottom:1px solid #374151; padding-bottom:10px;">‡∏´‡πâ‡∏≠‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
            <div id="room-list">Loading...</div>
        </div>
    </div>

    <div id="room-screen" style="display:none; position:fixed; inset:0; background:var(--bg); z-index:1500; padding:10px;">
        <div class="chat-container">
            <div class="chat-header">
                <span id="room-title" style="font-weight:bold;">Room Name</span>
                <div>
                    <button class="btn btn-green" style="width:auto; padding:5px 15px; font-size:0.9rem;" onclick="transferFunds()">üí∏ ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤</button>
                    <button class="btn btn-red" style="width:auto; padding:5px 15px;" onclick="leaveRoom()">‡∏≠‡∏≠‡∏Å</button>
                </div>
            </div>
            <div id="chat-msgs" class="chat-messages"></div>
            <div class="chat-input-area">
                <input id="chat-txt" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°..." style="margin:0;">
                <button class="btn btn-primary" style="width:60px;" onclick="sendMsg()"><i class="fa-solid fa-paper-plane"></i></button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA2NTzJKFK3GtULDl-l2EvEH3VamDh-VZI",
            authDomain: "chat-27f96.firebaseapp.com",
            projectId: "chat-27f96",
            storageBucket: "chat-27f96.firebasestorage.app",
            messagingSenderId: "336686938010",
            appId: "1:336686938010:web:9ea0e0ddd8d93e8358ec23"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentUser = null;
        let currentRoomId = null;
        let myBalance = 0;

        auth.onAuthStateChanged(user => {
            if(user) {
                // Check if banned
                db.collection('users').doc(user.uid).get().then(doc => {
                    if(doc.exists && doc.data().status === 'banned') {
                        Swal.fire('‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ñ‡∏π‡∏Å‡∏£‡∏∞‡∏á‡∏±‡∏ö','‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô','error').then(()=> auth.signOut());
                    } else {
                        currentUser = user;
                        document.getElementById('auth-screen').style.display = 'none';
                        document.getElementById('app').style.display = 'block';
                        loadUserData();
                        loadRooms();
                    }
                });
            } else {
                document.getElementById('auth-screen').style.display = 'flex';
                document.getElementById('app').style.display = 'none';
            }
        });

        // --- AUTH ---
        function toggleAuth(mode) {
            document.getElementById('login-form').style.display = mode==='login'?'block':'none';
            document.getElementById('reg-form').style.display = mode==='reg'?'block':'none';
        }

        async function register() {
            const email = document.getElementById('r-email').value;
            const pass = document.getElementById('r-pass').value;
            const name = document.getElementById('r-name').value;
            const bank = document.getElementById('r-bank').value;
            const bankNo = document.getElementById('r-bank-no').value;
            const accName = document.getElementById('r-acc-name').value;

            if(!email || !pass || !name || !bankNo) return Swal.fire('‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö','','warning');

            try {
                const cred = await auth.createUserWithEmailAndPassword(email, pass);
                await db.collection('users').doc(cred.user.uid).set({
                    username: name, email: email, balance: 0,
                    bankInfo: { bank, bankNo, accName },
                    status: 'active', role: 'user', createdAt: new Date()
                });
                Swal.fire('‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','','success').then(()=> toggleAuth('login'));
            } catch(e) { Swal.fire('Error', e.message, 'error'); }
        }

        async function login() {
            try {
                await auth.signInWithEmailAndPassword(
                    document.getElementById('l-email').value,
                    document.getElementById('l-pass').value
                );
            } catch(e) { Swal.fire('Error', '‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î', 'error'); }
        }

        function loadUserData() {
            db.collection('users').doc(currentUser.uid).onSnapshot(doc => {
                myBalance = doc.data().balance || 0;
                document.getElementById('my-bal').innerText = myBalance.toLocaleString();
            });
        }

        // --- ROOMS ---
        async function createRoomPopup() {
            const { value: form } = await Swal.fire({
                title: '‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢',
                html: `<input id="swal-room" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ / ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á">
                       <input id="swal-pass" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡πâ‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">`,
                focusConfirm: false,
                preConfirm: () => [document.getElementById('swal-room').value, document.getElementById('swal-pass').value]
            });
            if(form && form[0]) {
                const ref = await db.collection('rooms').add({
                    name: form[0], password: form[1], creatorId: currentUser.uid, 
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                enterRoom(ref.id, form[1]);
            }
        }

        function loadRooms() {
            db.collection('rooms').orderBy('createdAt', 'desc').onSnapshot(snap => {
                const div = document.getElementById('room-list');
                div.innerHTML = '';
                snap.forEach(doc => {
                    const r = doc.data();
                    const lockIcon = r.password ? '<i class="fa-solid fa-lock locked-icon"></i>' : '';
                    div.innerHTML += `
                        <div class="room-card">
                            <div><b>${r.name}</b> ${lockIcon}</div>
                            <button class="btn btn-primary" style="width:auto; padding:5px 15px;" onclick="checkRoom('${doc.id}', '${r.password}')">‡πÄ‡∏Ç‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á</button>
                        </div>
                    `;
                });
            });
        }

        async function checkRoom(roomId, roomPass) {
            if(roomPass) {
                const { value: pass } = await Swal.fire({input:'text', title:'‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏´‡πâ‡∏≠‡∏á'});
                if(pass !== roomPass) return Swal.fire('‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î','','error');
            }
            enterRoom(roomId);
        }

        // --- CHAT & TRADE LOGIC ---
        let unsubChat = null;

        function enterRoom(roomId) {
            currentRoomId = roomId;
            document.getElementById('room-screen').style.display = 'block';
            
            // Listen Messages
            if(unsubChat) unsubChat();
            unsubChat = db.collection('rooms').doc(roomId).collection('messages')
                .orderBy('timestamp', 'asc')
                .onSnapshot(snap => {
                    const div = document.getElementById('chat-msgs');
                    div.innerHTML = '';
                    snap.forEach(doc => {
                        const m = doc.data();
                        let cls = 'msg-other';
                        if(m.senderId === currentUser.uid) cls = 'msg-me';
                        if(m.type === 'system') cls = 'msg-system';
                        
                        div.innerHTML += `<div class="msg ${cls}">${m.text}</div>`;
                    });
                    div.scrollTop = div.scrollHeight;
                });
        }

        function leaveRoom() {
            currentRoomId = null;
            if(unsubChat) unsubChat();
            document.getElementById('room-screen').style.display = 'none';
        }

        function sendMsg() {
            const txt = document.getElementById('chat-txt').value;
            if(!txt || !currentRoomId) return;
            db.collection('rooms').doc(currentRoomId).collection('messages').add({
                text: txt, senderId: currentUser.uid, type: 'text',
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            });
            document.getElementById('chat-txt').value = '';
        }

        // üí∞ ‡∏£‡∏∞‡∏ö‡∏ö‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (Escrow Transfer)
        async function transferFunds() {
            const { value: amount } = await Swal.fire({
                title: '‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ',
                text: '‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏≠‡∏ô‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
                input: 'number',
                inputLabel: '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô',
                showCancelButton: true
            });

            if(amount) {
                const val = parseFloat(amount);
                if(val > myBalance) return Swal.fire('‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠','','error');

                // ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å User ‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á ‡πÅ‡∏ï‡πà‡πÉ‡∏ô Prototype ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡πÇ‡∏≠‡∏ô‡πÉ‡∏´‡πâ "‡∏≠‡∏µ‡∏Å‡∏ù‡πà‡∏≤‡∏¢" 
                // ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ‡∏£‡∏∞‡∏ö‡∏ö Generate Code. ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏á‡πà‡∏≤‡∏¢: ‡πÉ‡∏™‡πà Email ‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö
                const { value: receiverEmail } = await Swal.fire({input:'email', title:'‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô (‡∏Ñ‡∏π‡πà‡∏Ñ‡πâ‡∏≤)'});
                if(!receiverEmail) return;

                // Process
                try {
                    const rSnap = await db.collection('users').where('email','==',receiverEmail).get();
                    if(rSnap.empty) throw "‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ô‡∏µ‡πâ";
                    const receiverId = rSnap.docs[0].id;
                    const receiverBal = rSnap.docs[0].data().balance;

                    await db.runTransaction(async (t) => {
                        const myRef = db.collection('users').doc(currentUser.uid);
                        const rRef = db.collection('users').doc(receiverId);
                        
                        t.update(myRef, { balance: myBalance - val });
                        t.update(rRef, { balance: receiverBal + val });

                        // Log Transaction in Chat
                        const msgRef = db.collection('rooms').doc(currentRoomId).collection('messages').doc();
                        t.set(msgRef, {
                            text: `üí∞ ${currentUser.email} ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô ${val} ‡∏ö‡∏≤‡∏ó ‡πÉ‡∏´‡πâ ${receiverEmail}`,
                            senderId: 'system', type: 'system', timestamp: new Date()
                        });
                    });
                    Swal.fire('‡πÇ‡∏≠‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à','','success');
                } catch(e) { Swal.fire('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', e.toString(), 'error'); }
            }
        }

        // --- WALLET ---
        async function depositPopup() {
            const { value: amt } = await Swal.fire({title:'‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô', input:'number', text:'‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô'});
            if(amt) {
                await db.collection('transactions').add({
                    uid: currentUser.uid, type: 'deposit', amount: parseFloat(amt), status: 'pending',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß','‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥','success');
            }
        }

        async function withdrawPopup() {
            const { value: amt } = await Swal.fire({title:'‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', input:'number', text:'‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô'});
            if(amt) {
                if(parseFloat(amt) > myBalance) return Swal.fire('‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠','','error');
                await db.collection('transactions').add({
                    uid: currentUser.uid, type: 'withdraw', amount: parseFloat(amt), status: 'pending',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                Swal.fire('‡πÅ‡∏à‡πâ‡∏á‡∏ñ‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß','‡∏£‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥','success');
            }
        }

        async function contactAdmin() {
            const { value: msg } = await Swal.fire({input:'textarea', title:'‡πÅ‡∏à‡πâ‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤/‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô'});
            if(msg) {
                await db.collection('support_chats').add({
                    uid: currentUser.uid, email: currentUser.email, message: msg, status: 'pending',
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                Swal.fire('‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß','','success');
            }
        }

        function logout() { auth.signOut(); }
    </script>
</body>
</html>
