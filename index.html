<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>FF Arena - Live Display</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;800&family=Russo+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #f1f5f9; color: #1e293b; overflow: hidden; }
        .font-head { font-family: 'Russo One', sans-serif; }
        
        /* Floating Animation */
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        .card-float { animation: float 5s ease-in-out infinite; }
        
        /* Announcement Scroll */
        .marquee-container { overflow: hidden; white-space: nowrap; }
        .marquee-text { display: inline-block; padding-left: 100%; animation: marquee 15s linear infinite; }
        @keyframes marquee { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }

        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            border: 1px solid #e2e8f0;
            box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.1);
        }
        
        ::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="h-screen flex flex-col relative">

    <div id="announcement-bar" class="bg-blue-600 text-white h-10 flex items-center overflow-hidden hidden relative z-50 shadow-md">
        <div class="bg-blue-800 h-full px-4 flex items-center font-bold z-10 text-sm uppercase">
            <i class="fa-solid fa-bullhorn mr-2"></i> ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®
        </div>
        <div class="marquee-container w-full">
            <div id="ann-text" class="marquee-text font-bold text-lg">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô...</div>
        </div>
    </div>

    <header class="pt-6 pb-2 text-center">
        <h1 class="text-4xl md:text-5xl font-head text-slate-800 tracking-wider drop-shadow-sm">1 VS 1 BATTLE</h1>
        <p class="text-slate-400 text-sm mt-1">‡∏à‡∏±‡∏î‡∏Ñ‡∏¥‡∏ß‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡πÇ‡∏î‡πÄ‡∏ô‡∏ó ‚Ä¢ ‡∏•‡πâ‡∏°‡πÅ‡∏ä‡∏°‡∏õ‡πå‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•</p>
    </header>

    <div class="flex-1 flex items-center justify-center gap-6 md:gap-12 px-10 pb-4">
        
        <div class="flex-1 max-w-md card-float">
            <div class="glass-panel rounded-3xl p-6 text-center border-t-4 border-yellow-500 relative">
                <div class="absolute -top-5 left-1/2 transform -translate-x-1/2 bg-yellow-500 text-white px-4 py-1 rounded-full text-xs font-bold shadow-lg tracking-widest">
                    KING üëë
                </div>
                
                <div class="mt-4 mb-2">
                    <div id="king-name" class="text-4xl md:text-5xl font-head text-slate-800 truncate">‡∏ß‡πà‡∏≤‡∏á</div>
                </div>
                
                <div class="flex justify-center items-center gap-2 bg-yellow-50 rounded-xl py-2 mt-4">
                    <span class="text-yellow-700 font-bold text-sm">‡∏ä‡∏ô‡∏∞‡∏ï‡πà‡∏≠‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á:</span>
                    <span id="king-wins" class="text-3xl font-head text-yellow-600">0</span>
                </div>
            </div>
        </div>

        <div class="z-10 animate__animated animate__pulse animate__infinite">
            <span class="font-head text-6xl text-slate-300 italic drop-shadow-lg">VS</span>
        </div>

        <div class="flex-1 max-w-md card-float" style="animation-delay: 2s;">
            <div class="glass-panel rounded-3xl p-6 text-center border-t-4 border-blue-500 relative">
                <div class="absolute -top-5 left-1/2 transform -translate-x-1/2 bg-blue-500 text-white px-4 py-1 rounded-full text-xs font-bold shadow-lg tracking-widest">
                    ‡∏ú‡∏π‡πâ‡∏ó‡πâ‡∏≤‡∏ä‡∏¥‡∏á ‚öîÔ∏è
                </div>
                
                <div class="mt-4 mb-2">
                    <div id="chal-name" class="text-4xl md:text-5xl font-head text-slate-800 truncate">‡∏ß‡πà‡∏≤‡∏á</div>
                </div>
                
                <div class="flex justify-center items-center gap-2 bg-blue-50 rounded-xl py-2 mt-4">
                    <span class="text-blue-700 font-bold text-sm">‡∏¢‡∏≠‡∏î‡πÇ‡∏î‡πÄ‡∏ô‡∏ó:</span>
                    <span id="chal-donate" class="text-3xl font-head text-blue-600">0</span>
                </div>
            </div>
        </div>

    </div>

    <div class="bg-white border-t border-slate-200 p-4 shadow-inner">
        <div class="flex items-center justify-between mb-3 px-2">
            <div class="flex items-center gap-2">
                <div class="w-1.5 h-6 bg-slate-800 rounded-full"></div>
                <h2 class="text-lg font-bold text-slate-700">‡∏Ñ‡∏¥‡∏ß‡∏£‡∏≠‡πÄ‡∏•‡πà‡∏ô (‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡πÇ‡∏î‡πÄ‡∏ô‡∏ó)</h2>
            </div>
            <div class="bg-slate-100 px-3 py-1 rounded-lg text-xs font-bold text-slate-500">
                ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="q-total" class="text-slate-800 text-sm">0</span> ‡∏Ñ‡∏¥‡∏ß
            </div>
        </div>

        <div id="queue-list" class="flex gap-3 overflow-x-auto pb-2 h-24 items-center">
            </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBt4Hsmdf6BITdtYvysSMnkmfwFX_4Pm8s",
            authDomain: "hubfu-c4296.firebaseapp.com",
            projectId: "hubfu-c4296",
            storageBucket: "hubfu-c4296.firebasestorage.app",
            messagingSenderId: "864674622740",
            appId: "1:864674622740:web:3131798892e0e63e12a601"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // 1. King
        db.collection('arena_queue').where('status', '==', 'king').onSnapshot(s => {
            const n = document.getElementById('king-name');
            if(!s.empty) {
                const d = s.docs[0].data();
                n.innerText = d.name;
                document.getElementById('king-wins').innerText = d.wins || 0;
                n.classList.add('animate__animated','animate__fadeInDown');
                setTimeout(()=>n.classList.remove('animate__animated','animate__fadeInDown'), 1000);
            } else { n.innerText = "‡∏£‡∏≠‡πÅ‡∏ä‡∏°‡∏õ‡πå"; document.getElementById('king-wins').innerText = 0; }
        });

        // 2. Challenger
        db.collection('arena_queue').where('status', '==', 'challenger').onSnapshot(s => {
            const n = document.getElementById('chal-name');
            if(!s.empty) {
                const d = s.docs[0].data();
                n.innerText = d.name;
                document.getElementById('chal-donate').innerText = d.donate;
                n.classList.add('animate__animated','animate__fadeInUp');
                setTimeout(()=>n.classList.remove('animate__animated','animate__fadeInUp'), 1000);
            } else { n.innerText = "‡∏£‡∏≠‡∏Ñ‡∏¥‡∏ß"; document.getElementById('chal-donate').innerText = "-"; }
        });

        // 3. Waiting List
        db.collection('arena_queue').where('status', '==', 'waiting').orderBy('donate', 'desc').orderBy('timestamp', 'asc').onSnapshot(s => {
            const l = document.getElementById('queue-list');
            document.getElementById('q-total').innerText = s.size;
            l.innerHTML = '';
            s.docs.forEach((doc, i) => {
                const d = doc.data();
                const style = i===0 ? 'bg-yellow-50 border-yellow-300 ring-2 ring-yellow-100' : 'bg-white border-slate-200';
                l.innerHTML += `
                    <div class="min-w-[160px] h-20 ${style} border rounded-xl p-3 flex flex-col justify-between shadow-sm animate__animated animate__fadeInRight" style="animation-delay:${i*0.1}s">
                        <div class="flex justify-between"><span class="text-xs font-bold text-slate-400">#${i+1}</span> <span class="font-bold text-green-500 text-sm">‡∏ø${d.donate}</span></div>
                        <div class="font-bold text-slate-700 truncate">${d.name}</div>
                    </div>
                `;
            });
            if(s.empty) l.innerHTML = '<span class="text-slate-400 w-full text-center">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏¥‡∏ß...</span>';
        });

        // 4. Announcements
        db.collection('announcements').doc('config').onSnapshot(doc => {
            const bar = document.getElementById('announcement-bar');
            if(doc.exists && doc.data().active) {
                bar.classList.remove('hidden');
                document.getElementById('ann-text').innerText = doc.data().text;
            } else {
                bar.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
